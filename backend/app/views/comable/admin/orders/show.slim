#comable-order.comable-page
  .comable-page-heading
    ul.pull-right.list-inline
      li.btn-group
        = link_to Comable.t('admin.nav.orders.customer'), comable.admin_customer_path(@order.customer), class: 'btn btn-default'
        / TODO: Comment out after implemented.
        / = link_to Comable.t('admin.nav.orders.cart'), '#', class: 'btn btn-default'
        / = link_to Comable.t('admin.nav.orders.shipment'), '#', class: 'btn btn-default'
        / = link_to Comable.t('admin.nav.orders.payment'), '#', class: 'btn btn-default'

    h1.page-header
      ol.breadcrumb
        li>
          = link_to Comable.t('admin.nav.order'), comable.admin_orders_path
        li.active
          = @order.code
          small< data-toggle="tooltip" data-placement="right" title="#{l @order.completed_at}"
            = time_ago_in_words @order.completed_at

  .comable-page-body.row
    section.col-sm-8
      .panel.panel-default
        table.table
          thead
            tr
              th colspan="2"
                = @order.order_details.klass.human_attribute_name(:product)
              th
                = @order.order_details.klass.human_attribute_name(:price)
              th
                = @order.order_details.klass.human_attribute_name(:quantity)
              th
                = @order.order_details.klass.human_attribute_name(:subtotal_price)
          tbody
            - @order.order_details.each do |order_detail|
              tr
                td width="180"
                  = image_tag order_detail.image_url, width: '100%'
                td
                  = order_detail.name_with_sku
                  .text-muted
                    small = order_detail.code
                td
                  = number_to_currency order_detail.price
                td
                  = number_with_delimiter order_detail.quantity
                td
                  = number_to_currency order_detail.subtotal_price
            tr
              th.text-right colspan="4"
                = @order.class.human_attribute_name(:item_total_price)
              td
                = number_to_currency @order.item_total_price
            tr
              th.text-right colspan="4"
                = @order.class.human_attribute_name(:shipment_fee)
              td
                = number_to_currency @order.shipment_fee
            tr
              th.text-right colspan="4"
                = @order.class.human_attribute_name(:total_price)
              td
                = number_to_currency @order.total_price

    nav.col-sm-4
      .panel.panel-default
        .panel-body
          h3.text-center
            small>
              = @order.class.human_attribute_name(:total_price)
            = number_to_currency @order.total_price

      - if @order.bill_address
        .panel.panel-default
          .panel-heading
            .panel-title
              = @order.class.human_attribute_name(:bill_address)
          .panel-body
            .pull-right
              .comable-avatar
                = mail_to @order.email, class: 'thumbnail' do
                  = gravatar_tag @order.email, width: '100%'

            ul.list-unstyled
              li = @order.bill_address.zip_code
              li
                strong>
                  = @order.bill_address.full_name
              li = @order.bill_address.state_name
              li = @order.bill_address.city
              li = @order.bill_address.detail
              li = "#{@order.bill_address.class.human_attribute_name(:phone_number)}: #{@order.bill_address.phone_number}"

      - if @order.ship_address
        .panel.panel-default
          .panel-heading
            .panel-title
              = @order.class.human_attribute_name(:ship_address)
          .panel-body
            ul.list-unstyled
              li = @order.ship_address.zip_code
              li = @order.ship_address.full_name
              li = @order.ship_address.state_name
              li = @order.ship_address.city
              li = @order.ship_address.detail
              li = "#{@order.ship_address.class.human_attribute_name(:phone_number)}: #{@order.ship_address.phone_number}"

      - if @order.shipment_method
        .panel.panel-default
          .panel-heading
            .panel-title
              = @order.class.human_attribute_name(:shipment_method)
          .panel-body
            = @order.shipment_method.name

      - if @order.payment_method
        .panel.panel-default
          .panel-heading
            .panel-title
              = @order.class.human_attribute_name(:payment_method)
          .panel-body
            = @order.payment_method.name
